import ROOT
from fullLims_1cat import getAsymLimits,makeAFillGraph,makeAGraph
from massplot import end,make2DGraph,avtotwidth,parser
import math,sys,time,os,glob,tdrstyle
from array import array
tdrstyle.setTDRStyle()
ROOT.gStyle.SetPadRightMargin(0.18);
ROOT.gStyle.SetPadLeftMargin(0.18);
ROOT.gStyle.SetPadTopMargin(0.10);
Number=6
Red=  [0.000, 0.000 , 0.000, 1.000, 1.000, 1.000]
Green=[0.749, 1.000 , 1.000, 1.000, 0.502, 0.000]
Blue= [1.000, 0.749 , 0.000, 0.000, 0.000, 1.000]
Length=[]
for i in range(Number-1):
  Length.append(1/float(Number-1)*i)
Length.append(1.000)
r=array('d',Red)
g=array('d',Green)
b=array('d',Blue)
l=array('d',Length)

ROOT.TColor.CreateGradientColorTable(Number,l,r,g,b,100)
#ROOT.gStyle.SetPalette(57)

def merge(iPGraph,color,iX=-1,iXMax=100000):
    x = array('d', [])
    y = array('d', [])
    #x.append(500)
    #y.append(iCGraph.GetY()[0#])
    #for i0 in range(0,iCGraph.GetN()):
    #    if iCGraph.GetX()[i0] > iX and iX > 0:
    #        break
    #    x.append(iCGraph.GetX()[i0])
    #    y.append(iCGraph.GetY()[i0])

    for i0 in range(0,iPGraph.GetN()):
        if iPGraph.GetX()[i0] > iXMax:
            break
        if iX < 0:
            x.append(iPGraph.GetX()[i0])
            y.append(iPGraph.GetY()[i0])
        elif iPGraph.GetX()[i0] > iX:
            x.append(iPGraph.GetX()[i0])
            y.append(iPGraph.GetY()[i0])
    lGraph    = makeAGraph( x, y, color, 3 )
    lGraph.SetMarkerColor(color)
    return lGraph


def dijetexp(color,i90CL=False):
    if i90CL:
        lPFile = ROOT.TFile("PF90CL.root")
        lPGraph = lPFile.Get("exp")
        lCFile = ROOT.TFile("Calo90CL.root")
        lCGraph = lCFile.Get("exp")
        lGraph = merge(lPGraph,lCGraph,color,1400,3900)
        return lGraph
    lPFile1=ROOT.TFile('limits_freq_qq_pfdijet2017_95CL_Dataset.root')
    lPGraph = lPFile1.Get("exp1sigma_qq_pfdijet2017")

    lGraph = merge(lPGraph,color,1400,5500)
    return lGraph
    x = array('d', [])
    y = array('d', [])
    #x.append(500)
    #y.append(8.619535664753032)
    x.append(601.9305019305019)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(601.9305019305019))
    x.append(650.1930501930501)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(650.1930501930501))
    x.append(698.4555984555984)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(698.4555984555984))
    x.append(746.7181467181467)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(746.7181467181467))
    x.append(812.3552123552123)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(812.3552123552123))
    x.append(879.9227799227799)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(879.9227799227799))
    x.append(953.2818532818533)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(953.2818532818533))
    x.append(1032.4324324324325)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(1032.4324324324325))
    x.append(1117.3745173745174)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(1117.3745173745174))
    x.append(1204.2471042471043)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(1204.2471042471043))
    x.append(1291.1196911196912)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(1291.1196911196912))
    x.append(1377.992277992278)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(1377.992277992278))
    x.append(1447.4903474903476)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(1447.4903474903476))
    x.append(1526.6409266409269)
    y.append(calo.Get('exp_qq_calodijet2016').Eval(1526.6409266409269))
    x.append(1835.5653097740994)
    y.append(pf.Get('exp_qq_pfdijet2016').Eval(1835.5653097740994))
    x.append(2093.5706031462005)
    y.append(pf.Get('exp_qq_pfdijet2016').Eval(2093.5706031462005))
    x.append(2341.333967046895)
    y.append(pf.Get('exp_qq_pfdijet2016').Eval(2341.333967046895))
    x.append(2578.7249310370526)
    y.append(pf.Get('exp_qq_pfdijet2016').Eval(2578.7249310370526))
    x.append(2754.175054052038)
    y.append(pf.Get('exp_qq_pfdijet2016').Eval(2754.175054052038))
    x.append(3043.297547155743)
    y.append(pf.Get('exp_qq_pfdijet2016').Eval(3043.297547155743))
    x.append(3435.7200104376343)
    y.append(pf.Get('exp_qq_pfdijet2016').Eval(3435.7200104376343))
    x.append(3797.188362036829)
    y.append(pf.Get('exp_qq_pfdijet2016').Eval(3797.188362036829))
    #x.append(4138.0097666443)
    #y.append(0.010394256012614915)
    #x.append(4437.53727726832)
    #y.append(0.007783059964888597)
    #x.append(4809.37802877805)
    #y.append(0.005500486503683233)
    #x.append(5201.8657272795035)
    #y.append(0.0037763370738787476)
    #x.append(5656.294266756131)
    #y.append(0.002376824781618676)
    #x.append(6162.454335346305)
    #y.append(0.0015404057465133833)
    #x.append(6658.307239245508)
    #y.append(0.0010277152713018512)
    #x.append(7081.879519868783)
    #y.append(0.0007478854520557367)
    #x.append(7515.922053231939)
    #y.append(0.0006113493020261009)
    #x.append(7826.148139864309)
    #y.append(0.0006301833652603328)
    #x.append(7971.035562513977)
    #y.append(0.0007082739961764732)
    lGraph    = makeAGraph( x, y, color, 3 )
    lGraph.SetMarkerColor(color)
    return lGraph

def dijetobs(color,i90CL=False):
    if i90CL:
        lPFile  = ROOT.TFile("PF90CL.root")
        lPGraph = lPFile.Get("obs")
        lCFile  = ROOT.TFile("Calo90CL.root")
        lCGraph = lCFile.Get("obs")
        lGraph  = merge(lCGraph,color,1400,5000)
        return lGraph
#    lPFile = ROOT.TFile("limits_freq_qq_calodijet2016_pfdijet2016.root")
#    lPFile1 = ROOT.TFile("limits_freq_qq_calodijet2016.root")
    lPFile2 = ROOT.TFile("limits_freq_qq_pfdijet2017_95CL_Dataset.root")
#    lCGraph = lPFile1.Get("obs_qq_calodijet2016")
    lCGraph = lPFile2.Get("obs_qq_pfdijet2017")
    lGraph = merge(lCGraph,color,1400,5500)
    return lGraph
    x = array('d', [])
    y = array('d', [])
    #x.append(500)
    #y.append(4.417344703140073)
    x.append(598.0694980694981)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(598.0694980694981))
    x.append(630.8880308880309)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(630.8880308880309))
    x.append(654.0540540540541)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(654.0540540540541))
    x.append(694.5945945945946)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(694.5945945945946))
    x.append(729.3436293436293)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(729.3436293436293))
    x.append(764.0926640926641)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(764.0926640926641))
    x.append(802.7027027027027)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(802.7027027027027))
    x.append(850.965250965251)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(850.965250965251))
    x.append(901.1583011583012)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(901.1583011583012))
    x.append(949.4208494208494)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(949.4208494208494))
    x.append(1001.5444015444016)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(1001.5444015444016))
    x.append(1053.6679536679537)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(1053.6679536679537))
    x.append(1103.861003861004)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(1103.861003861004))
    x.append(1152.1235521235521)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(1152.1235521235521))
    x.append(1202.3166023166023)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(1202.3166023166023))
    x.append(1250.5791505791508)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(1250.5791505791508))
    x.append(1300.772200772201)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(1300.772200772201))
    x.append(1347.1042471042472)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(1347.1042471042472))
    x.append(1406.949806949807)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(1406.949806949807))
    x.append(1451.3513513513512)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(1451.3513513513512))
    x.append(1497.6833976833977)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(1497.6833976833977))
    x.append(1545.9459459459463)
    y.append(lPFile1.Get('obs_qq_calodijet2016').Eval(1545.9459459459463))
    x.append(1601.930501930502)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(1601.930501930502))
    x.append(1773.4939983598003)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(1773.4939983598003))
    x.append(1856.1470215462607)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(1856.1470215462607))
    x.append(1949.1398270334746)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(1949.1398270334746))
    x.append(2104.399649593677)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(2104.399649593677))
    x.append(2228.313949153806)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(2228.313949153806))
    x.append(2279.686684559755)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(2279.686684559755))
    x.append(2341.268731827331)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(2341.268731827331))
    x.append(2402.91601431447)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(2402.91601431447))
    x.append(2506.118131663312)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(2506.118131663312))
    x.append(2537.13747856557)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(2537.13747856557))
    x.append(2640.6657720122266)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(2640.6657720122266))
    x.append(2764.9388652799516)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(2764.9388652799516))
    x.append(2878.676470588234)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(2878.676470588234))
    x.append(2971.6040408558847)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(2971.6040408558847))
    x.append(3074.8061582047267)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(3074.8061582047267))
    x.append(3167.440169984343)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(3167.440169984343))
    x.append(3229.2179229106086)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(3229.2179229106086))
    x.append(3311.773093267725)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(3311.773093267725))
    x.append(3425.412845746663)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(3425.412845746663))
    x.append(3507.9027808842166)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(3507.9027808842166))
    x.append(3631.8170804443444)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(3631.8170804443444))
    x.append(3797.188362036829)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(3797.188362036829))
    x.append(3880.004473272198)
    y.append(lPFile2.Get('obs_qq_pfdijet2016').Eval(3880.004473272198)) 
   #x.append(4014.291172742861)
    #y.append(0.014301172804579109)
    #x.append(4096.781107880414)
    #y.append(0.011673263156169997)
    #x.append(4199.754901960783)
    #y.append(0.008004607532669124)
    #x.append(4292.519384179526)
    #y.append(0.006165135029541548)
    #x.append(4395.656266308803)
    #y.append(0.004888573359511099)
    #x.append(4509.328636397525)
    #y.append(0.004614774148116912)
    #x.append(4674.797770819354)
    #y.append(0.004754085899371195)
    #x.append(4778.293446656227)
    #y.append(0.005189296395244354)
    #x.append(4902.240363826138)
    #y.append(0.004622306281508651)
    #x.append(5036.527063296801)
    #y.append(0.004117443041530253)
    #x.append(5139.663945426078)
    #y.append(0.003264879400966817)
    #x.append(5273.91802728696)
    #y.append(0.0028249949084984487)
    #x.append(5418.740214717065)
    #y.append(0.002995817276430047)
    #x.append(5563.56240214717)
    #y.append(0.0031769689661235974)
    #x.append(5739.240848430627)
    #y.append(0.0029139008040259193)
    #x.append(5945.840788786996)
    #y.append(0.002449838209903935)
    #x.append(6121.388764631328)
    #y.append(0.0020004411218901654)
    #x.append(6266.015246402742)
    #y.append(0.0017820229509131172)
    #x.append(6266.015246402742)
    #y.append(0.0017820229509131172)
    #x.append(6431.256057556102)
    #y.append(0.0014979640103628745)
    #x.append(6431.256057556102)
    #y.append(0.0014979640103628745)
    #x.append(6596.464251099679)
    #y.append(0.0012231257522893248)
    #x.append(6782.286774025198)
    #y.append(0.0009424133022435063)
    #x.append(6906.201073585326)
    #y.append(0.0008154048580218117)
    #x.append(7092.219302169536)
    #y.append(0.000747917549775239)
    #x.append(7236.943636770297)
    #y.append(0.0007269362219934222)
    #x.append(7236.943636770297)
    #y.append(0.0007269362219934222)
    #x.append(7402.380153582345)
    #y.append(0.0007274355606432079)
    #x.append(7516.117758890628)
    #y.append(0.0007277790549174683)
    #x.append(7702.266457913961)
    #y.append(0.000749813755546937)
    #x.append(7867.800827555356)
    #y.append(0.0008186658745549854)
    #x.append(8002.446320733617)
    #y.append(0.0010038700029024285)
    lGraph    = makeAGraph( x, y, color, 3 )
    lGraph.SetMarkerColor(color)
    return lGraph

def dijetxs(color):
    x = array('d', [])
    y = array('d', [])
    v = True 
    if v:
#      x.append(500)
#      y.append(53.088896)
#      x.append(1000)
#      y.append(4.36988822)
#      x.append(1500)
#      y.append(0.79225344)
#      x.append(1800)
#      y.append(0.328192761)
#      x.append(1850)
#      y.append(0.291486468)
#      x.append(1900)
#      y.append(0.255722285)
#      x.append(1950)
#      y.append(0.221615421)
#      x.append(2000)
#      y.append(0.197382687)
#      x.append(2050)
#      y.append(0.172207705)
#      x.append(2100)
#      y.append(0.151872695)
#      x.append(2150)
#      y.append(0.132865362)
#      x.append(2200)
#      y.append(0.119653168)
#      x.append(2250)
#      y.append(0.10592325)
#      x.append(2300)
#      y.append(0.093760045)
#      x.append(2350)
#      y.append(0.082462696)
#      x.append(2400)
#      y.append(0.072743034)
#      x.append(2450)
#      y.append(0.066333462)
#      x.append(2500)
#      y.append(0.058459076)
#      x.append(2550)
#      y.append(0.052267432)
#      x.append(2600)
#      y.append(0.0466491248)
#      x.append(2650)
#      y.append(0.0412177488)
#      x.append(2700)
#      y.append(0.0376700324)
#      x.append(2750)
#      y.append(0.0337084692)
#      x.append(2800)
#      y.append(0.0300574278)
#      x.append(3000)
#      y.append(0.0197948408)
#      x.append(3500)
#      y.append(0.0072222648)
#      x.append(4000)
#      y.append(0.00293975808)
#      x.append(4500)
#      y.append(0.00125176576)
#      x.append(5000)
#      y.append(0.00058481674)
#      x.append(5500)
#      y.append(0.000306748216)
#      x.append(6000)
#      y.append(0.00017600644)
#      x.append(6500)
#      y.append(0.0001053256)
#      x.append(7000)
#      y.append(6.6086196e-05)
	 x.append(500)
	 y.append(59.614102)
	 x.append(510)
	 y.append(57.1915217478)
	 x.append(520)
	 y.append(54.7689414956)
	 x.append(530)
	 y.append(52.3463612434)
	 x.append(540)
	 y.append(49.9237809912)
	 x.append(550)
	 y.append(47.501200739)
	 x.append(560)
	 y.append(45.0786204868)
	 x.append(570)
	 y.append(42.6560402346)
	 x.append(580)
	 y.append(40.2334599824)
	 x.append(590)
	 y.append(37.8108797301)
	 x.append(600)
	 y.append(35.3882994779)
	 x.append(610)
	 y.append(33.9502002263)
	 x.append(620)
	 y.append(32.5121009746)
	 x.append(630)
	 y.append(31.074001723)
	 x.append(640)
	 y.append(29.6359024713)
	 x.append(650)
	 y.append(28.1978032197)
	 x.append(660)
	 y.append(26.759703968)
	 x.append(670)
	 y.append(25.3216047163)
	 x.append(680)
	 y.append(23.8835054647)
	 x.append(690)
	 y.append(22.445406213)
	 x.append(700)
	 y.append(21.0073069614)
	 x.append(710)
	 y.append(20.1536182319)
	 x.append(720)
	 y.append(19.2999295024)
	 x.append(730)
	 y.append(18.4462407729)
	 x.append(740)
	 y.append(17.5925520434)
	 x.append(750)
	 y.append(16.7388633139)
	 x.append(760)
	 y.append(15.8851745844)
	 x.append(770)
	 y.append(15.0314858549)
	 x.append(780)
	 y.append(14.1777971254)
	 x.append(790)
	 y.append(13.3241083959)
	 x.append(800)
	 y.append(12.4704196664)
	 x.append(810)
	 y.append(11.9636504388)
	 x.append(820)
	 y.append(11.4568812113)
	 x.append(830)
	 y.append(10.9501119838)
	 x.append(840)
	 y.append(10.4433427563)
	 x.append(850)
	 y.append(9.93657352872)
	 x.append(860)
	 y.append(9.42980430119)
	 x.append(870)
	 y.append(8.92303507366)
	 x.append(880)
	 y.append(8.41626584613)
	 x.append(890)
	 y.append(7.9094966186)
	 x.append(900)
	 y.append(7.40272739107)
	 x.append(910)
	 y.append(7.10189754396)
	 x.append(920)
	 y.append(6.80106769685)
	 x.append(930)
	 y.append(6.50023784975)
	 x.append(940)
	 y.append(6.19940800264)
	 x.append(950)
	 y.append(5.89857815553)
	 x.append(960)
	 y.append(5.59774830843)
	 x.append(970)
	 y.append(5.29691846132)
	 x.append(980)
	 y.append(4.99608861421)
	 x.append(990)
	 y.append(4.69525876711)
	 x.append(1000)
	 y.append(4.39442892)
	 x.append(1010)
	 y.append(4.26341595418)
	 x.append(1020)
	 y.append(4.13240298836)
	 x.append(1030)
	 y.append(4.00139002254)
	 x.append(1040)
	 y.append(3.87037705672)
	 x.append(1050)
	 y.append(3.7393640909)
	 x.append(1060)
	 y.append(3.60835112507)
	 x.append(1070)
	 y.append(3.47733815925)
	 x.append(1080)
	 y.append(3.34632519343)
	 x.append(1090)
	 y.append(3.21531222761)
	 x.append(1100)
	 y.append(3.08429926179)
	 x.append(1110)
	 y.append(2.99234574494)
	 x.append(1120)
	 y.append(2.90039222808)
	 x.append(1130)
	 y.append(2.80843871122)
	 x.append(1140)
	 y.append(2.71648519437)
	 x.append(1150)
	 y.append(2.62453167751)
	 x.append(1160)
	 y.append(2.53257816066)
	 x.append(1170)
	 y.append(2.4406246438)
	 x.append(1180)
	 y.append(2.34867112695)
	 x.append(1190)
	 y.append(2.25671761009)
	 x.append(1200)
	 y.append(2.16476409323)
	 x.append(1210)
	 y.append(2.10022506682)
	 x.append(1220)
	 y.append(2.0356860404)
	 x.append(1230)
	 y.append(1.97114701398)
	 x.append(1240)
	 y.append(1.90660798757)
	 x.append(1250)
	 y.append(1.84206896115)
	 x.append(1260)
	 y.append(1.77752993473)
	 x.append(1270)
	 y.append(1.71299090831)
	 x.append(1280)
	 y.append(1.6484518819)
	 x.append(1290)
	 y.append(1.58391285548)
	 x.append(1300)
	 y.append(1.51937382906)
	 x.append(1310)
	 y.append(1.47407609523)
	 x.append(1320)
	 y.append(1.42877836141)
	 x.append(1330)
	 y.append(1.38348062758)
	 x.append(1340)
	 y.append(1.33818289376)
	 x.append(1350)
	 y.append(1.29288515993)
	 x.append(1360)
	 y.append(1.2475874261)
	 x.append(1370)
	 y.append(1.20228969228)
	 x.append(1380)
	 y.append(1.15699195845)
	 x.append(1390)
	 y.append(1.11169422463)
	 x.append(1400)
	 y.append(1.0663964908)
	 x.append(1410)
	 y.append(1.03460356172)
	 x.append(1420)
	 y.append(1.00281063264)
	 x.append(1430)
	 y.append(0.97101770356)
	 x.append(1440)
	 y.append(0.93922477448)
	 x.append(1450)
	 y.append(0.9074318454)
	 x.append(1460)
	 y.append(0.87563891632)
	 x.append(1470)
	 y.append(0.84384598724)
	 x.append(1480)
	 y.append(0.81205305816)
	 x.append(1490)
	 y.append(0.78026012908)
	 x.append(1500)
	 y.append(0.7484672)
	 x.append(1510)
	 y.append(0.729957298163)
	 x.append(1520)
	 y.append(0.711447396326)
	 x.append(1530)
	 y.append(0.692937494489)
	 x.append(1540)
	 y.append(0.674427592652)
	 x.append(1550)
	 y.append(0.655917690815)
	 x.append(1560)
	 y.append(0.637407788978)
	 x.append(1570)
	 y.append(0.618897887142)
	 x.append(1580)
	 y.append(0.600387985305)
	 x.append(1590)
	 y.append(0.581878083468)
	 x.append(1600)
	 y.append(0.563368181631)
	 x.append(1610)
	 y.append(0.549435854683)
	 x.append(1620)
	 y.append(0.535503527735)
	 x.append(1630)
	 y.append(0.521571200788)
	 x.append(1640)
	 y.append(0.50763887384)
	 x.append(1650)
	 y.append(0.493706546892)
	 x.append(1660)
	 y.append(0.479774219945)
	 x.append(1670)
	 y.append(0.465841892997)
	 x.append(1680)
	 y.append(0.451909566049)
	 x.append(1690)
	 y.append(0.437977239101)
	 x.append(1700)
	 y.append(0.424044912154)
	 x.append(1710)
	 y.append(0.413558106989)
	 x.append(1720)
	 y.append(0.403071301825)
	 x.append(1730)
	 y.append(0.39258449666)
	 x.append(1740)
	 y.append(0.382097691496)
	 x.append(1750)
	 y.append(0.371610886331)
	 x.append(1760)
	 y.append(0.361124081167)
	 x.append(1770)
	 y.append(0.350637276002)
	 x.append(1780)
	 y.append(0.340150470838)
	 x.append(1790)
	 y.append(0.329663665673)
	 x.append(1800)
	 y.append(0.319176860509)
	 x.append(1810)
	 y.append(0.311283485413)
	 x.append(1820)
	 y.append(0.303390110317)
	 x.append(1830)
	 y.append(0.295496735221)
	 x.append(1840)
	 y.append(0.287603360125)
	 x.append(1850)
	 y.append(0.279709985029)
	 x.append(1860)
	 y.append(0.271816609933)
	 x.append(1870)
	 y.append(0.263923234837)
	 x.append(1880)
	 y.append(0.256029859741)
	 x.append(1890)
	 y.append(0.248136484645)
	 x.append(1900)
	 y.append(0.240243109549)
	 x.append(1910)
	 y.append(0.234301798594)
	 x.append(1920)
	 y.append(0.228360487639)
	 x.append(1930)
	 y.append(0.222419176684)
	 x.append(1940)
	 y.append(0.216477865729)
	 x.append(1950)
	 y.append(0.210536554775)
	 x.append(1960)
	 y.append(0.20459524382)
	 x.append(1970)
	 y.append(0.198653932865)
	 x.append(1980)
	 y.append(0.19271262191)
	 x.append(1990)
	 y.append(0.186771310955)
	 x.append(2000)
	 y.append(0.18083)
	 x.append(2010)
	 y.append(0.17677271424)
	 x.append(2020)
	 y.append(0.17271542848)
	 x.append(2030)
	 y.append(0.16865814272)
	 x.append(2040)
	 y.append(0.164600856961)
	 x.append(2050)
	 y.append(0.160543571201)
	 x.append(2060)
	 y.append(0.156486285441)
	 x.append(2070)
	 y.append(0.152428999681)
	 x.append(2080)
	 y.append(0.148371713921)
	 x.append(2090)
	 y.append(0.144314428161)
	 x.append(2100)
	 y.append(0.140257142401)
	 x.append(2110)
	 y.append(0.137110190532)
	 x.append(2120)
	 y.append(0.133963238662)
	 x.append(2130)
	 y.append(0.130816286793)
	 x.append(2140)
	 y.append(0.127669334923)
	 x.append(2150)
	 y.append(0.124522383053)
	 x.append(2160)
	 y.append(0.121375431184)
	 x.append(2170)
	 y.append(0.118228479314)
	 x.append(2180)
	 y.append(0.115081527445)
	 x.append(2190)
	 y.append(0.111934575575)
	 x.append(2200)
	 y.append(0.108787623705)
	 x.append(2210)
	 y.append(0.106346753957)
	 x.append(2220)
	 y.append(0.10390588421)
	 x.append(2230)
	 y.append(0.101465014462)
	 x.append(2240)
	 y.append(0.0990241447138)
	 x.append(2250)
	 y.append(0.096583274966)
	 x.append(2260)
	 y.append(0.0941424052181)
	 x.append(2270)
	 y.append(0.0917015354702)
	 x.append(2280)
	 y.append(0.0892606657224)
	 x.append(2290)
	 y.append(0.0868197959745)
	 x.append(2300)
	 y.append(0.0843789262266)
	 x.append(2310)
	 y.append(0.0824857148357)
	 x.append(2320)
	 y.append(0.0805925034449)
	 x.append(2330)
	 y.append(0.078699292054)
	 x.append(2340)
	 y.append(0.0768060806631)
	 x.append(2350)
	 y.append(0.0749128692723)
	 x.append(2360)
	 y.append(0.0730196578814)
	 x.append(2370)
	 y.append(0.0711264464905)
	 x.append(2380)
	 y.append(0.0692332350997)
	 x.append(2390)
	 y.append(0.0673400237088)
	 x.append(2400)
	 y.append(0.0654468123179)
	 x.append(2410)
	 y.append(0.0639783810861)
	 x.append(2420)
	 y.append(0.0625099498543)
	 x.append(2430)
	 y.append(0.0610415186226)
	 x.append(2440)
	 y.append(0.0595730873908)
	 x.append(2450)
	 y.append(0.058104656159)
	 x.append(2460)
	 y.append(0.0566362249272)
	 x.append(2470)
	 y.append(0.0551677936954)
	 x.append(2480)
	 y.append(0.0536993624636)
	 x.append(2490)
	 y.append(0.0522309312318)
	 x.append(2500)
	 y.append(0.0507625)
	 x.append(2510)
	 y.append(0.0496778788981)
	 x.append(2520)
	 y.append(0.0485932577961)
	 x.append(2530)
	 y.append(0.0475086366942)
	 x.append(2540)
	 y.append(0.0464240155923)
	 x.append(2550)
	 y.append(0.0453393944904)
	 x.append(2560)
	 y.append(0.0442547733884)
	 x.append(2570)
	 y.append(0.0431701522865)
	 x.append(2580)
	 y.append(0.0420855311846)
	 x.append(2590)
	 y.append(0.0410009100827)
	 x.append(2600)
	 y.append(0.0399162889807)
	 x.append(2610)
	 y.append(0.0390634143323)
	 x.append(2620)
	 y.append(0.0382105396839)
	 x.append(2630)
	 y.append(0.0373576650356)
	 x.append(2640)
	 y.append(0.0365047903872)
	 x.append(2650)
	 y.append(0.0356519157388)
	 x.append(2660)
	 y.append(0.0347990410904)
	 x.append(2670)
	 y.append(0.033946166442)
	 x.append(2680)
	 y.append(0.0330932917936)
	 x.append(2690)
	 y.append(0.0322404171452)
	 x.append(2700)
	 y.append(0.0313875424968)
	 x.append(2710)
	 y.append(0.0307168980067)
	 x.append(2720)
	 y.append(0.0300462535166)
	 x.append(2730)
	 y.append(0.0293756090264)
	 x.append(2740)
	 y.append(0.0287049645363)
	 x.append(2750)
	 y.append(0.0280343200462)
	 x.append(2760)
	 y.append(0.0273636755561)
	 x.append(2770)
	 y.append(0.026693031066)
	 x.append(2780)
	 y.append(0.0260223865759)
	 x.append(2790)
	 y.append(0.0253517420857)
	 x.append(2800)
	 y.append(0.0246810975956)
	 x.append(2810)
	 y.append(0.0241537469082)
	 x.append(2820)
	 y.append(0.0236263962207)
	 x.append(2830)
	 y.append(0.0230990455333)
	 x.append(2840)
	 y.append(0.0225716948459)
	 x.append(2850)
	 y.append(0.0220443441584)
	 x.append(2860)
	 y.append(0.021516993471)
	 x.append(2870)
	 y.append(0.0209896427836)
	 x.append(2880)
	 y.append(0.0204622920961)
	 x.append(2890)
	 y.append(0.0199349414087)
	 x.append(2900)
	 y.append(0.0194075907213)
	 x.append(2910)
	 y.append(0.0189929168491)
	 x.append(2920)
	 y.append(0.018578242977)
	 x.append(2930)
	 y.append(0.0181635691049)
	 x.append(2940)
	 y.append(0.0177488952328)
	 x.append(2950)
	 y.append(0.0173342213606)
	 x.append(2960)
	 y.append(0.0169195474885)
	 x.append(2970)
	 y.append(0.0165048736164)
	 x.append(2980)
	 y.append(0.0160901997443)
	 x.append(2990)
	 y.append(0.0156755258721)
	 x.append(3000)
	 y.append(0.015260852)
	 x.append(3010)
	 y.append(0.0149485495827)
	 x.append(3020)
	 y.append(0.0146362471653)
	 x.append(3030)
	 y.append(0.014323944748)
	 x.append(3040)
	 y.append(0.0140116423306)
	 x.append(3050)
	 y.append(0.0136993399133)
	 x.append(3060)
	 y.append(0.013387037496)
	 x.append(3070)
	 y.append(0.0130747350786)
	 x.append(3080)
	 y.append(0.0127624326613)
	 x.append(3090)
	 y.append(0.012450130244)
	 x.append(3100)
	 y.append(0.0121378278266)
	 x.append(3110)
	 y.append(0.0118894358645)
	 x.append(3120)
	 y.append(0.0116410439024)
	 x.append(3130)
	 y.append(0.0113926519403)
	 x.append(3140)
	 y.append(0.0111442599782)
	 x.append(3150)
	 y.append(0.0108958680162)
	 x.append(3160)
	 y.append(0.0106474760541)
	 x.append(3170)
	 y.append(0.010399084092)
	 x.append(3180)
	 y.append(0.0101506921299)
	 x.append(3190)
	 y.append(0.00990230016778)
	 x.append(3200)
	 y.append(0.00965390820569)
	 x.append(3210)
	 y.append(0.00945634788144)
	 x.append(3220)
	 y.append(0.00925878755719)
	 x.append(3230)
	 y.append(0.00906122723295)
	 x.append(3240)
	 y.append(0.0088636669087)
	 x.append(3250)
	 y.append(0.00866610658445)
	 x.append(3260)
	 y.append(0.00846854626021)
	 x.append(3270)
	 y.append(0.00827098593596)
	 x.append(3280)
	 y.append(0.00807342561171)
	 x.append(3290)
	 y.append(0.00787586528747)
	 x.append(3300)
	 y.append(0.00767830496322)
	 x.append(3310)
	 y.append(0.00752117394582)
	 x.append(3320)
	 y.append(0.00736404292843)
	 x.append(3330)
	 y.append(0.00720691191103)
	 x.append(3340)
	 y.append(0.00704978089364)
	 x.append(3350)
	 y.append(0.00689264987624)
	 x.append(3360)
	 y.append(0.00673551885885)
	 x.append(3370)
	 y.append(0.00657838784145)
	 x.append(3380)
	 y.append(0.00642125682406)
	 x.append(3390)
	 y.append(0.00626412580666)
	 x.append(3400)
	 y.append(0.00610699478927)
	 x.append(3410)
	 y.append(0.00598201951034)
	 x.append(3420)
	 y.append(0.00585704423142)
	 x.append(3430)
	 y.append(0.00573206895249)
	 x.append(3440)
	 y.append(0.00560709367356)
	 x.append(3450)
	 y.append(0.00548211839463)
	 x.append(3460)
	 y.append(0.00535714311571)
	 x.append(3470)
	 y.append(0.00523216783678)
	 x.append(3480)
	 y.append(0.00510719255785)
	 x.append(3490)
	 y.append(0.00498221727893)
	 x.append(3500)
	 y.append(0.004857242)
	 x.append(3510)
	 y.append(0.00476170076135)
	 x.append(3520)
	 y.append(0.00466615952271)
	 x.append(3530)
	 y.append(0.00457061828406)
	 x.append(3540)
	 y.append(0.00447507704542)
	 x.append(3550)
	 y.append(0.00437953580677)
	 x.append(3560)
	 y.append(0.00428399456813)
	 x.append(3570)
	 y.append(0.00418845332948)
	 x.append(3580)
	 y.append(0.00409291209084)
	 x.append(3590)
	 y.append(0.00399737085219)
	 x.append(3600)
	 y.append(0.00390182961354)
	 x.append(3610)
	 y.append(0.00382508119659)
	 x.append(3620)
	 y.append(0.00374833277964)
	 x.append(3630)
	 y.append(0.00367158436268)
	 x.append(3640)
	 y.append(0.00359483594573)
	 x.append(3650)
	 y.append(0.00351808752878)
	 x.append(3660)
	 y.append(0.00344133911182)
	 x.append(3670)
	 y.append(0.00336459069487)
	 x.append(3680)
	 y.append(0.00328784227791)
	 x.append(3690)
	 y.append(0.00321109386096)
	 x.append(3700)
	 y.append(0.00313434544401)
	 x.append(3710)
	 y.append(0.00307269332824)
	 x.append(3720)
	 y.append(0.00301104121248)
	 x.append(3730)
	 y.append(0.00294938909672)
	 x.append(3740)
	 y.append(0.00288773698096)
	 x.append(3750)
	 y.append(0.0028260848652)
	 x.append(3760)
	 y.append(0.00276443274944)
	 x.append(3770)
	 y.append(0.00270278063368)
	 x.append(3780)
	 y.append(0.00264112851792)
	 x.append(3790)
	 y.append(0.00257947640216)
	 x.append(3800)
	 y.append(0.0025178242864)
	 x.append(3810)
	 y.append(0.0024682990515)
	 x.append(3820)
	 y.append(0.0024187738166)
	 x.append(3830)
	 y.append(0.0023692485817)
	 x.append(3840)
	 y.append(0.0023197233468)
	 x.append(3850)
	 y.append(0.0022701981119)
	 x.append(3860)
	 y.append(0.002220672877)
	 x.append(3870)
	 y.append(0.0021711476421)
	 x.append(3880)
	 y.append(0.0021216224072)
	 x.append(3890)
	 y.append(0.0020720971723)
	 x.append(3900)
	 y.append(0.0020225719374)
	 x.append(3910)
	 y.append(0.00198278824366)
	 x.append(3920)
	 y.append(0.00194300454992)
	 x.append(3930)
	 y.append(0.00190322085618)
	 x.append(3940)
	 y.append(0.00186343716244)
	 x.append(3950)
	 y.append(0.0018236534687)
	 x.append(3960)
	 y.append(0.00178386977496)
	 x.append(3970)
	 y.append(0.00174408608122)
	 x.append(3980)
	 y.append(0.00170430238748)
	 x.append(3990)
	 y.append(0.00166451869374)
	 x.append(4000)
	 y.append(0.001624735)
	 x.append(4010)
	 y.append(0.00159277670054)
	 x.append(4020)
	 y.append(0.00156081840109)
	 x.append(4030)
	 y.append(0.00152886010163)
	 x.append(4040)
	 y.append(0.00149690180217)
	 x.append(4050)
	 y.append(0.00146494350272)
	 x.append(4060)
	 y.append(0.00143298520326)
	 x.append(4070)
	 y.append(0.0014010269038)
	 x.append(4080)
	 y.append(0.00136906860434)
	 x.append(4090)
	 y.append(0.00133711030489)
	 x.append(4100)
	 y.append(0.00130515200543)
	 x.append(4110)
	 y.append(0.00127947985666)
	 x.append(4120)
	 y.append(0.0012538077079)
	 x.append(4130)
	 y.append(0.00122813555913)
	 x.append(4140)
	 y.append(0.00120246341036)
	 x.append(4150)
	 y.append(0.0011767912616)
	 x.append(4160)
	 y.append(0.00115111911283)
	 x.append(4170)
	 y.append(0.00112544696406)
	 x.append(4180)
	 y.append(0.0010997748153)
	 x.append(4190)
	 y.append(0.00107410266653)
	 x.append(4200)
	 y.append(0.00104843051776)
	 x.append(4210)
	 y.append(0.00102780804306)
	 x.append(4220)
	 y.append(0.00100718556835)
	 x.append(4230)
	 y.append(0.000986563093637)
	 x.append(4240)
	 y.append(0.000965940618928)
	 x.append(4250)
	 y.append(0.000945318144219)
	 x.append(4260)
	 y.append(0.00092469566951)
	 x.append(4270)
	 y.append(0.000904073194801)
	 x.append(4280)
	 y.append(0.000883450720091)
	 x.append(4290)
	 y.append(0.000862828245382)
	 x.append(4300)
	 y.append(0.000842205770673)
	 x.append(4310)
	 y.append(0.000825639706531)
	 x.append(4320)
	 y.append(0.00080907364239)
	 x.append(4330)
	 y.append(0.000792507578248)
	 x.append(4340)
	 y.append(0.000775941514106)
	 x.append(4350)
	 y.append(0.000759375449964)
	 x.append(4360)
	 y.append(0.000742809385822)
	 x.append(4370)
	 y.append(0.00072624332168)
	 x.append(4380)
	 y.append(0.000709677257538)
	 x.append(4390)
	 y.append(0.000693111193396)
	 x.append(4400)
	 y.append(0.000676545129255)
	 x.append(4410)
	 y.append(0.000663237585663)
	 x.append(4420)
	 y.append(0.000649930042072)
	 x.append(4430)
	 y.append(0.000636622498481)
	 x.append(4440)
	 y.append(0.000623314954889)
	 x.append(4450)
	 y.append(0.000610007411298)
	 x.append(4460)
	 y.append(0.000596699867707)
	 x.append(4470)
	 y.append(0.000583392324115)
	 x.append(4480)
	 y.append(0.000570084780524)
	 x.append(4490)
	 y.append(0.000556777236933)
	 x.append(4500)
	 y.append(0.000543469693341)
	 x.append(4510)
	 y.append(0.000532779724081)
	 x.append(4520)
	 y.append(0.000522089754821)
	 x.append(4530)
	 y.append(0.000511399785562)
	 x.append(4540)
	 y.append(0.000500709816302)
	 x.append(4550)
	 y.append(0.000490019847042)
	 x.append(4560)
	 y.append(0.000479329877782)
	 x.append(4570)
	 y.append(0.000468639908522)
	 x.append(4580)
	 y.append(0.000457949939262)
	 x.append(4590)
	 y.append(0.000447259970002)
	 x.append(4600)
	 y.append(0.000436570000742)
	 x.append(4610)
	 y.append(0.000427982732777)
	 x.append(4620)
	 y.append(0.000419395464811)
	 x.append(4630)
	 y.append(0.000410808196846)
	 x.append(4640)
	 y.append(0.000402220928881)
	 x.append(4650)
	 y.append(0.000393633660915)
	 x.append(4660)
	 y.append(0.00038504639295)
	 x.append(4670)
	 y.append(0.000376459124985)
	 x.append(4680)
	 y.append(0.000367871857019)
	 x.append(4690)
	 y.append(0.000359284589054)
	 x.append(4700)
	 y.append(0.000350697321089)
	 x.append(4710)
	 y.append(0.000343799156153)
	 x.append(4720)
	 y.append(0.000336900991218)
	 x.append(4730)
	 y.append(0.000330002826283)
	 x.append(4740)
	 y.append(0.000323104661348)
	 x.append(4750)
	 y.append(0.000316206496412)
	 x.append(4760)
	 y.append(0.000309308331477)
	 x.append(4770)
	 y.append(0.000302410166542)
	 x.append(4780)
	 y.append(0.000295512001607)
	 x.append(4790)
	 y.append(0.000288613836671)
	 x.append(4800)
	 y.append(0.000281715671736)
	 x.append(4810)
	 y.append(0.000276174365739)
	 x.append(4820)
	 y.append(0.000270633059742)
	 x.append(4830)
	 y.append(0.000265091753745)
	 x.append(4840)
	 y.append(0.000259550447748)
	 x.append(4850)
	 y.append(0.000254009141751)
	 x.append(4860)
	 y.append(0.000248467835754)
	 x.append(4870)
	 y.append(0.000242926529757)
	 x.append(4880)
	 y.append(0.00023738522376)
	 x.append(4890)
	 y.append(0.000231843917763)
	 x.append(4900)
	 y.append(0.000226302611766)
	 x.append(4910)
	 y.append(0.000221851272542)
	 x.append(4920)
	 y.append(0.000217399933317)
	 x.append(4930)
	 y.append(0.000212948594093)
	 x.append(4940)
	 y.append(0.000208497254869)
	 x.append(4950)
	 y.append(0.000204045915644)
	 x.append(4960)
	 y.append(0.00019959457642)
	 x.append(4970)
	 y.append(0.000195143237195)
	 x.append(4980)
	 y.append(0.000190691897971)
	 x.append(4990)
	 y.append(0.000186240558747)
	 x.append(5000)
	 y.append(0.000181789219522)
	 x.append(5010)
	 y.append(0.000178213452203)
	 x.append(5020)
	 y.append(0.000174637684884)
	 x.append(5030)
	 y.append(0.000171061917564)
	 x.append(5040)
	 y.append(0.000167486150245)
	 x.append(5050)
	 y.append(0.000163910382926)
	 x.append(5060)
	 y.append(0.000160334615606)
	 x.append(5070)
	 y.append(0.000156758848287)
	 x.append(5080)
	 y.append(0.000153183080968)
	 x.append(5090)
	 y.append(0.000149607313649)
	 x.append(5100)
	 y.append(0.000146031546329)
	 x.append(5110)
	 y.append(0.000143159127204)
	 x.append(5120)
	 y.append(0.000140286708078)
	 x.append(5130)
	 y.append(0.000137414288953)
	 x.append(5140)
	 y.append(0.000134541869828)
	 x.append(5150)
	 y.append(0.000131669450702)
	 x.append(5160)
	 y.append(0.000128797031577)
	 x.append(5170)
	 y.append(0.000125924612451)
	 x.append(5180)
	 y.append(0.000123052193326)
	 x.append(5190)
	 y.append(0.0001201797742)
	 x.append(5200)
	 y.append(0.000117307355075)
	 x.append(5210)
	 y.append(0.000114999936584)
	 x.append(5220)
	 y.append(0.000112692518093)
	 x.append(5230)
	 y.append(0.000110385099602)
	 x.append(5240)
	 y.append(0.000108077681111)
	 x.append(5250)
	 y.append(0.00010577026262)
	 x.append(5260)
	 y.append(0.000103462844129)
	 x.append(5270)
	 y.append(0.000101155425638)
	 x.append(5280)
	 y.append(9.88480071469e-05)
	 x.append(5290)
	 y.append(9.65405886559e-05)
	 x.append(5300)
	 y.append(9.42331701649e-05)
	 x.append(5310)
	 y.append(9.23796175112e-05)
	 x.append(5320)
	 y.append(9.05260648574e-05)
	 x.append(5330)
	 y.append(8.86725122036e-05)
	 x.append(5340)
	 y.append(8.68189595499e-05)
	 x.append(5350)
	 y.append(8.49654068961e-05)
	 x.append(5360)
	 y.append(8.31118542424e-05)
	 x.append(5370)
	 y.append(8.12583015886e-05)
	 x.append(5380)
	 y.append(7.94047489348e-05)
	 x.append(5390)
	 y.append(7.75511962811e-05)
	 x.append(5400)
	 y.append(7.56976436273e-05)
	 x.append(5410)
	 y.append(7.42086820654e-05)
	 x.append(5420)
	 y.append(7.27197205036e-05)
	 x.append(5430)
	 y.append(7.12307589417e-05)
	 x.append(5440)
	 y.append(6.97417973798e-05)
	 x.append(5450)
	 y.append(6.8252835818e-05)
	 x.append(5460)
	 y.append(6.67638742561e-05)
	 x.append(5470)
	 y.append(6.52749126942e-05)
	 x.append(5480)
	 y.append(6.37859511324e-05)
	 x.append(5490)
	 y.append(6.22969895705e-05)
    else:

      x.append(500)
      y.append(60.14113)
      x.append(1000)
      y.append(4.42547616)
      x.append(1500)
      y.append(0.7571358)
      x.append(1800)
      y.append(0.310112064)
      x.append(1850)
      y.append(0.26617037)
      x.append(1900)
      y.append(0.235984552)
      x.append(1950)
      y.append(0.20858418)
      x.append(2000)
      y.append(0.1818336)
      x.append(2050)
      y.append(0.156303936)
      x.append(2100)
      y.append(0.135815946)
      x.append(2150)
      y.append(0.121970058)
      x.append(2200)
      y.append(0.106092126)
      x.append(2250)
      y.append(0.093963767)
      x.append(2300)
      y.append(0.080591)
      x.append(2350)
      y.append(0.071953414)
      x.append(2400)
      y.append(0.064723741)
      x.append(2450)
      y.append(0.056408674)
      x.append(2500)
      y.append(0.049592333)
      x.append(2550)
      y.append(0.045233174)
      x.append(2600)
      y.append(0.039405779)
      x.append(2650)
      y.append(0.034789025)
      x.append(2700)
      y.append(0.031481101)
      x.append(2750)
      y.append(0.028296221)
      x.append(2800)
      y.append(0.024758081)
      x.append(3000)
      y.append(0.01552742)
      x.append(3500)
      y.append(0.004936807)
      x.append(4000)
      y.append(0.001680786)
    lGraph    = makeAGraph( x, y, color, 3 )
    lGraph.SetMarkerColor(color)
    return lGraph

def divide(iG,iXS,iGB=False,iGDM=1,iGQ=0.25,iMDM=1.):
    for i0 in range(0,iG.GetN()):
        iG.GetY()[i0] = iG.GetY()[i0]/iXS.Eval(iG.GetX()[i0])/(5./6.)
        lDMWidth = avtotwidth(2,iGDM,iGQ,iG.GetX()[i0],iMDM)
        lWidth   = avtotwidth(2,0.  ,iGQ,iG.GetX()[i0],iMDM)
        iG.GetY()[i0] = (lWidth/lDMWidth)*iG.GetY()[i0]
        if iGB:
            iG.GetY()[i0]=(math.sqrt(iG.GetY()[i0]))*0.25*6
            
def main(iAxial,i90CL,iExp,iGB):
    leg = ROOT.TLegend(0.207,0.782,0.427,0.935)
    leg.SetHeader("")
    leg.SetFillColor(0)    
    leg.SetBorderSize(0)  
    leg.SetTextFont(42)
    leg.SetFillStyle(0)  
    canv0 = ROOT.TCanvas("can0","can0",1200,800)
    exp=dijetexp(ROOT.kGreen,i90CL)
    obs=dijetobs(ROOT.kRed  ,i90CL)
    xs=dijetxs(ROOT.kBlack)
    divide(exp,xs,True)
    divide(obs,xs,True)
    exp.GetXaxis().SetTitle("m_{med}")
    exp.GetYaxis().SetTitle("g_{B}")
    #exp.GetYaxis().SetTitle("#sigma_{J}(m_{med})")
    #exp.GetYaxis().SetTitle("#mu=#sigma_{J}/#sigma_{0}")
    if iGB:
        exp.Draw("alp")
        obs.Draw("lp")
        lFile = ROOT.TFile("Output.root","RECREATE")
        exp.SetName("exp")
        obs.SetName("obs")
        exp.Write()
        obs.Write()
        lFile.Close()
        #xs .Draw("lp")                                                                                                                                      #leg.AddEntry(exp,"expected","lp")
        leg.AddEntry(obs,"observed","lp")
        leg.AddEntry(exp,"expected","lp")
        leg.Draw()
        canv0.Update()
        #leg.AddEntry(xs ,"DM Model","lp")
        end()
        exit()
    gdm=1
    canv1 = ROOT.TCanvas("can1","can1",1200,800)
#    canv1.cd(1)
#    frame = canv1.cd(1).DrawFrame(600,0,3700,1700)
    lCL="90" if i90CL else "95"
    print 'exp\n\n\n\n\n\n'
    lExp,lXExp=make2DGraph(exp,gdm,canv1,leg,"Expected",1,iAxial)
    print 'obs\n\n\n\n\n\n'
    lObs,lXObs=make2DGraph(obs,gdm,canv1,leg,"Observed",ROOT.kBlack,iAxial)
    if iExp:
	    lExp.GetYaxis().SetRangeUser(0,2300)
	    lExp.GetXaxis().SetRangeUser(600,4000)
	    lExp.GetYaxis().SetTitle('m_{DM} [GeV]')
            lExp.GetXaxis().SetTitle('Mediator mass [GeV]')
	    lExp.Draw("colz")
	    
    else:
	    lObs.Draw("colz")
	    lObs.GetYaxis().SetRangeUser(0,2300)
            lObs.GetXaxis().SetRangeUser(600,4000)
            lObs.GetYaxis().SetTitle('m_{DM} [GeV]')
            lObs.GetXaxis().SetTitle('Mediator mass [GeV]')

    lXObs.SetFillColor(ROOT.kOrange+5)
    lXObs.SetFillStyle(3001)
    lXExp.SetLineStyle(ROOT.kDashed)

    lXExp.Draw("l sames")
    lXObs.Draw("l sames")
    leg.Draw()
    leg11 = ROOT.TLatex(1700,2370,'CMS #bf{Preliminary}')
    leg1=ROOT.TLatex(3300,2370,'77.8 fb^{-1} (13 TeV)')
    leg1.SetTextFont(42)
    leg1.SetTextSize(0.045)
    leg2=ROOT.TLatex(16500,1600,'#scale[1]{CMS}')
#    leg2.SetTextFont(42)
    leg2.SetTextSize(0.045)
    leg11.Draw()
    leg1.Draw()
    leg2.Draw()

#    pad=ROOT.TPad('mypad','mypad',0.93,0.8,1.00,1)
#    pad.Draw()
    leg3=ROOT.TLatex(4900,1600,'#scale[1]{Coupling #font[11]{g}_{q}}')
#    leg3.SetFillColor(0)
    leg3.SetTextAngle(90)
    leg3.SetTextFont(42)
    leg4=ROOT.TLatex(2000,870,'#splitline{#scale[0.78]{Vector mediator}}{#scale[0.78]{& Dirac DM}}')
    leg4.SetTextFont(42)
    leg4.Draw()
    leg5=ROOT.TLatex(2000,383,'#splitline{#scale[0.78]{g_{DM} = 1.0}}{#scale[0.78]{g_{q} = 0.25}}')
    leg5.SetTextFont(42)
    leg5.Draw()
    leg6=ROOT.TLatex(2000,630,'#scale[0.78]{95% CL Limits}')

    leg6.SetTextFont(42)
    leg6.Draw()
    leg3.Draw('same')
    canv1.Update()
    ROOT.gPad.Modified()
    ROOT.gPad.RedrawAxis()
    
    fileend="_dijet_v" if iAxial else "_dijet_v"
    fileend=fileend+"_90" if i90CL else fileend
    fileend=fileend+"_Exp" if iExp else fileend
    canv1.SaveAs("gq_mdm_mmed"+fileend+".png")
    canv1.SaveAs("gq_mdm_mmed"+fileend+".pdf")
    lFile = ROOT.TFile("MMedMDM"+fileend+".root","RECREATE")
    lObs.SetName("obs")
    lObs.SetTitle("obs")
    lExp.SetName("exp")
    lExp.SetTitle("exp")
    lXObs.SetName("obs_025")
    lXObs.SetTitle("obs_025")
    lXExp.SetName("exp_025")
    lXExp.SetTitle("exp_025")
    lObs.Write()
    lExp.Write()
    lXObs.Write()
    lXExp.Write()
    end()
        
if __name__ == '__main__':
    options=parser()
    main(options.Axial,options.CL90,options.Exp,options.gb)
